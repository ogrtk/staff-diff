<!DOCTYPE html>
<html>
<head>
    <title>PowerShell & SQLite データ同期システム - テスト結果</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background-color: #f0f0f0; padding: 20px; border-radius: 5px; }
        .summary { margin: 20px 0; }
        .passed { color: green; }
        .failed { color: red; }
        .skipped { color: orange; }
        .test-details { margin-top: 20px; }
        .test-container { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .test-name { font-weight: bold; }
        .test-time { color: #666; font-size: 0.9em; }
        .error-message { background-color: #ffebee; padding: 10px; margin: 10px 0; border-left: 4px solid #f44336; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PowerShell & SQLite データ同期システム</h1>
        <h2>テスト実行結果</h2>
        <p>実行日時: 2025年08月20日 22:43:30</p>
    </div>
    
    <div class="summary">
        <h3>実行サマリー</h3>
        <table>
            <tr><th>項目</th><th>件数</th></tr>
            <tr><td>総テスト数</td><td>28</td></tr>
            <tr><td class="passed">成功</td><td>17</td></tr>
            <tr><td class="failed">失敗</td><td>11</td></tr>
            <tr><td class="skipped">スキップ</td><td>0</td></tr>
            <tr><td>実行時間</td><td>00:03.362</td></tr>
        </table>
    </div>
    
    <div class="module-summary">
        <h3>モジュール別実行結果</h3>
        <table>
            <tr><th>モジュール</th><th>分類</th><th>総数</th><th>成功</th><th>失敗</th><th>スキップ</th><th>実行時間</th></tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Get-Sqlite3Path 関数</td>
                <td>3</td>
                <td class="passed">1</td>
                <td class="failed">2</td>
                <td class="skipped">0</td>
                <td>00:00.611</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCommand 関数</td>
                <td>3</td>
                <td class="passed">1</td>
                <td class="failed">2</td>
                <td class="skipped">0</td>
                <td>00:00.435</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvExport 関数</td>
                <td>3</td>
                <td class="passed">0</td>
                <td class="failed">3</td>
                <td class="skipped">0</td>
                <td>00:00.164</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvQuery 関数</td>
                <td>3</td>
                <td class="passed">1</td>
                <td class="failed">2</td>
                <td class="skipped">0</td>
                <td>00:00.342</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Test-PathSafe 関数</td>
                <td>4</td>
                <td class="passed">3</td>
                <td class="failed">1</td>
                <td class="skipped">0</td>
                <td>00:00.156</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] エラーハンドリングとエッジケース</td>
                <td>3</td>
                <td class="passed">2</td>
                <td class="failed">1</td>
                <td class="skipped">0</td>
                <td>00:00.205</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-CrossPlatformEncoding 関数</td>
                <td>2</td>
                <td class="passed">2</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:00.072</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>4</td>
                <td class="passed">4</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:00.074</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 統合テスト</td>
                <td>2</td>
                <td class="passed">2</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:00.074</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 関数のエクスポート確認</td>
                <td>1</td>
                <td class="passed">1</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:00.056</td>
            </tr>        </table>
    </div>    <div class="test-details">
        <h3>失敗したテスト</h3>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Get-Sqlite3Path 関数 - sqlite3コマンドが見つからない場合、エラーをスローする</div>
            <div class="test-time">実行時間: 00:00.158</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Expected an exception with message like '*sqlite3コマンドが見つかりません*' to be thrown, but no exception was thrown.
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Get-Sqlite3Path 関数 - Get-Commandでエラーが発生した場合、適切なエラーメッセージをスローする</div>
            <div class="test-time">実行時間: 00:00.030</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Expected an exception with message like '*SQLite3コマンドの取得に失敗しました*' to be thrown, but no exception was thrown.
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Test-PathSafe 関数 - 有効なパスが存在する場合、Trueを返す</div>
            <div class="test-time">実行時間: 00:00.073</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Expected $true, but got $false.
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCommand 関数 - 正常なクエリの場合、結果を返す</div>
            <div class="test-time">実行時間: 00:00.200</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：SELECT * FROM test_table; ,結果：Error: unable to open database "/test/database.db": unable to open database file ）
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCommand 関数 - 一時ファイルが適切に作成・削除される</div>
            <div class="test-time">実行時間: 00:00.099</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：SELECT 1; ,結果：Error: unable to open database "/test/database.db": unable to open database file ）
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCsvQuery 関数 - CSVクエリ結果を正しくパースして返す</div>
            <div class="test-time">実行時間: 00:00.144</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                SQLiteコマンド実行エラー: Error: unable to open database "/test/database.db": unable to open database file
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCsvQuery 関数 - 空の結果の場合、空配列を返す</div>
            <div class="test-time">実行時間: 00:00.124</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                SQLiteコマンド実行エラー: Error: unable to open database "/test/database.db": unable to open database file
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCsvExport 関数 - CSV出力が正常に実行される</div>
            <div class="test-time">実行時間: 00:00.059</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Could not find Command Write-SystemLog
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCsvExport 関数 - 空の結果の場合、0を返す</div>
            <div class="test-time">実行時間: 00:00.056</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Could not find Command Write-SystemLog
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] Invoke-SqliteCsvExport 関数 - SQLiteエラーの場合、例外をスローする</div>
            <div class="test-time">実行時間: 00:00.048</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Could not find Command Write-SystemLog
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[CoreUtils] [-] エラーハンドリングとエッジケース - Invoke-SqliteCommand で空のクエリを処理</div>
            <div class="test-time">実行時間: 00:00.105</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Expected no exception to be thrown, but an exception "SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：  ,結果：Error: unable to open database "/test/database.db": unable to open database file ）" was thrown from /workspaces/ps-sqlite/scripts/modules/Utils/Foundation/CoreUtils.psm1:112 char:9<br>    +         throw "SQLite3の実行に失敗しました: $($_.Exception.Message)"<br>    +         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~.
            </div>
        </div></div>    <div class="test-details">
        <h3>すべてのテスト結果</h3>
        <table>
            <tr>
                <th>モジュール</th>
                <th>分類</th>
                <th>テスト名</th>
                <th>結果</th>
                <th>実行時間</th>
                <th>詳細</th>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Get-Sqlite3Path 関数</td>
                <td>sqlite3コマンドが利用可能な場合、コマンド情報を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.422</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Get-Sqlite3Path 関数</td>
                <td>sqlite3コマンドが見つからない場合、エラーをスローする</td>
                <td class="failed">Failed</td>
                <td>00:00.158</td>
                <td>Expected an exception with message like '*sqlite3コマンドが見つかりません*' to be thrown, but no exception was thrown.</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Get-Sqlite3Path 関数</td>
                <td>Get-Commandでエラーが発生した場合、適切なエラーメッセージをスローする</td>
                <td class="failed">Failed</td>
                <td>00:00.030</td>
                <td>Expected an exception with message like '*SQLite3コマンドの取得に失敗しました*' to be thrown, but no exception was thrown.</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-CrossPlatformEncoding 関数</td>
                <td>PowerShell Core (6+) の場合、UTF8 (BOM なし) を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.037</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-CrossPlatformEncoding 関数</td>
                <td>Windows PowerShell (5.1) の場合、UTF8 (BOM あり) を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.034</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Test-PathSafe 関数</td>
                <td>有効なパスが存在する場合、Trueを返す</td>
                <td class="failed">Failed</td>
                <td>00:00.073</td>
                <td>Expected $true, but got $false.</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Test-PathSafe 関数</td>
                <td>パスが存在しない場合、Falseを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.016</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Test-PathSafe 関数</td>
                <td>パスがnullまたは空の場合、Falseを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.022</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Test-PathSafe 関数</td>
                <td>Test-Pathが呼び出されない場合（null/空文字）</td>
                <td class="passed">Passed</td>
                <td>00:00.044</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>デフォルトフォーマットでAsia/Tokyoタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.029</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>カスタムフォーマットでタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.009</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>異なるタイムゾーンでタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.018</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>無効なタイムゾーンの場合、フォールバック（UTC+9）を使用する</td>
                <td class="passed">Passed</td>
                <td>00:00.016</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCommand 関数</td>
                <td>正常なクエリの場合、結果を返す</td>
                <td class="failed">Failed</td>
                <td>00:00.200</td>
                <td>SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：SELECT * FROM test_table; ,結果：Error: unable to open database "/test/database.db": unable to open database file ）</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCommand 関数</td>
                <td>SQLiteコマンドがエラーを返す場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.135</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCommand 関数</td>
                <td>一時ファイルが適切に作成・削除される</td>
                <td class="failed">Failed</td>
                <td>00:00.099</td>
                <td>SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：SELECT 1; ,結果：Error: unable to open database "/test/database.db": unable to open database file ）</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvQuery 関数</td>
                <td>CSVクエリ結果を正しくパースして返す</td>
                <td class="failed">Failed</td>
                <td>00:00.144</td>
                <td>SQLiteコマンド実行エラー: Error: unable to open database "/test/database.db": unable to open database file</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvQuery 関数</td>
                <td>空の結果の場合、空配列を返す</td>
                <td class="failed">Failed</td>
                <td>00:00.124</td>
                <td>SQLiteコマンド実行エラー: Error: unable to open database "/test/database.db": unable to open database file</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvQuery 関数</td>
                <td>SQLiteエラーの場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.073</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvExport 関数</td>
                <td>CSV出力が正常に実行される</td>
                <td class="failed">Failed</td>
                <td>00:00.059</td>
                <td>Could not find Command Write-SystemLog</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvExport 関数</td>
                <td>空の結果の場合、0を返す</td>
                <td class="failed">Failed</td>
                <td>00:00.056</td>
                <td>Could not find Command Write-SystemLog</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] Invoke-SqliteCsvExport 関数</td>
                <td>SQLiteエラーの場合、例外をスローする</td>
                <td class="failed">Failed</td>
                <td>00:00.048</td>
                <td>Could not find Command Write-SystemLog</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 関数のエクスポート確認</td>
                <td>すべての期待される関数がエクスポートされている</td>
                <td class="passed">Passed</td>
                <td>00:00.056</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 統合テスト</td>
                <td>実際のタイムスタンプとエンコーディングの組み合わせテスト</td>
                <td class="passed">Passed</td>
                <td>00:00.023</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 統合テスト</td>
                <td>Test-PathSafeとGet-Timestampの組み合わせテスト</td>
                <td class="passed">Passed</td>
                <td>00:00.051</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] エラーハンドリングとエッジケース</td>
                <td>Get-Timestamp でフォーマット文字列が無効な場合の処理</td>
                <td class="passed">Passed</td>
                <td>00:00.023</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] エラーハンドリングとエッジケース</td>
                <td>Invoke-SqliteCommand で空のクエリを処理</td>
                <td class="failed">Failed</td>
                <td>00:00.105</td>
                <td>Expected no exception to be thrown, but an exception "SQLite3の実行に失敗しました: sqlite3コマンドエラー (終了コード: 1 ,クエリ：  ,結果：Error: unable to open database "/test/database.db": unable to open database file ）" was thrown from /workspaces/ps-sqlite/scripts/modules/Utils/Foundation/CoreUtils.psm1:112 char:9
    +         throw "SQLite3の実行に失敗しました: $($_.Exception.Message)"
    +         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~.</td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[-] エラーハンドリングとエッジケース</td>
                <td>複数の同時実行でのタイムスタンプ一意性確認</td>
                <td class="passed">Passed</td>
                <td>00:00.076</td>
                <td></td>
            </tr>        </table>
    </div></body>
</html>
