<!DOCTYPE html>
<html>
<head>
    <title>PowerShell & SQLite データ同期システム - テスト結果</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background-color: #f0f0f0; padding: 20px; border-radius: 5px; }
        .summary { margin: 20px 0; }
        .passed { color: green; }
        .failed { color: red; }
        .skipped { color: orange; }
        .test-details { margin-top: 20px; }
        .test-container { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .test-name { font-weight: bold; }
        .test-time { color: #666; font-size: 0.9em; }
        .error-message { background-color: #ffebee; padding: 10px; margin: 10px 0; border-left: 4px solid #f44336; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PowerShell & SQLite データ同期システム</h1>
        <h2>テスト実行結果</h2>
        <p>実行日時: 2025年08月26日 23:43:41</p>
    </div>
    
    <div class="summary">
        <h3>実行サマリー</h3>
        <table>
            <tr><th>項目</th><th>件数</th></tr>
            <tr><td>総テスト数</td><td>28</td></tr>
            <tr><td class="passed">成功</td><td>28</td></tr>
            <tr><td class="failed">失敗</td><td>0</td></tr>
            <tr><td class="skipped">スキップ</td><td>0</td></tr>
            <tr><td>実行時間</td><td>00:03.105</td></tr>
        </table>
    </div>
    
    <div class="module-summary">
        <h3>モジュール別実行結果</h3>
        <table>
            <tr><th>モジュール</th><th>総数</th><th>成功</th><th>失敗</th><th>スキップ</th><th>実行時間</th></tr>            <tr>
                <td>CoreUtils</td>
                <td>28</td>
                <td class="passed">28</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:01.921</td>
            </tr>        </table>
    </div>    <div class="test-details">
        <h3>すべてのテスト結果</h3>
        <table>
            <tr>
                <th>モジュール</th>
                <th>分類</th>
                <th>テスト名</th>
                <th>結果</th>
                <th>実行時間</th>
                <th>詳細</th>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Sqlite3Path 関数</td>
                <td>sqlite3コマンドが利用可能な場合、コマンド情報を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.449</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Sqlite3Path 関数</td>
                <td>sqlite3コマンドが見つからない場合、エラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.072</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Sqlite3Path 関数</td>
                <td>Get-Commandでエラーが発生した場合、適切なエラーメッセージをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.051</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-CrossPlatformEncoding 関数</td>
                <td>PowerShell Core (6+) の場合、UTF8 (BOM なし) を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.036</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-CrossPlatformEncoding 関数</td>
                <td>Windows PowerShell (5.1) の場合、UTF8 (BOM あり) を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.041</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Test-PathSafe 関数</td>
                <td>有効なパスが存在する場合、Trueを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.086</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Test-PathSafe 関数</td>
                <td>パスが存在しない場合、Falseを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.020</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Test-PathSafe 関数</td>
                <td>パスがnullまたは空の場合、Falseを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.011</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Test-PathSafe 関数</td>
                <td>Test-Pathが呼び出されない場合（null/空文字）</td>
                <td class="passed">Passed</td>
                <td>00:00.030</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>デフォルトフォーマットでAsia/Tokyoタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.030</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>カスタムフォーマットでタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.012</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>異なるタイムゾーンでタイムスタンプを返す</td>
                <td class="passed">Passed</td>
                <td>00:00.009</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Get-Timestamp 関数</td>
                <td>無効なタイムゾーンの場合、フォールバック（UTC+9）を使用する</td>
                <td class="passed">Passed</td>
                <td>00:00.018</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCommand 関数</td>
                <td>正常なクエリの場合、結果を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.141</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCommand 関数</td>
                <td>SQLiteコマンドがエラーを返す場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.074</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCommand 関数</td>
                <td>一時ファイルが適切に作成・削除される</td>
                <td class="passed">Passed</td>
                <td>00:00.068</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvQuery 関数</td>
                <td>CSVクエリ結果を正しくパースして返す</td>
                <td class="passed">Passed</td>
                <td>00:00.162</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvQuery 関数</td>
                <td>空の結果の場合、空配列を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.087</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvQuery 関数</td>
                <td>SQLiteエラーの場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.060</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvExport 関数</td>
                <td>CSV出力が正常に実行される</td>
                <td class="passed">Passed</td>
                <td>00:00.031</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvExport 関数</td>
                <td>空の結果の場合、0を返す</td>
                <td class="passed">Passed</td>
                <td>00:00.024</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] Invoke-SqliteCsvExport 関数</td>
                <td>SQLiteエラーの場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.036</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 関数のエクスポート確認</td>
                <td>すべての期待される関数がエクスポートされている</td>
                <td class="passed">Passed</td>
                <td>00:00.035</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 統合テスト</td>
                <td>実際のタイムスタンプとエンコーディングの組み合わせテスト</td>
                <td class="passed">Passed</td>
                <td>00:00.018</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] 統合テスト</td>
                <td>Test-PathSafeとGet-Timestampの組み合わせテスト</td>
                <td class="passed">Passed</td>
                <td>00:00.035</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>Get-Timestamp でフォーマット文字列が無効な場合の処理</td>
                <td class="passed">Passed</td>
                <td>00:00.014</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>Invoke-SqliteCommand で空のクエリを処理</td>
                <td class="passed">Passed</td>
                <td>00:00.166</td>
                <td></td>
            </tr>            <tr>
                <td>CoreUtils</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>複数の同時実行でのタイムスタンプ一意性確認</td>
                <td class="passed">Passed</td>
                <td>00:00.091</td>
                <td></td>
            </tr>        </table>
    </div></body>
</html>
