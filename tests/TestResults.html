<!DOCTYPE html>
<html>
<head>
    <title>PowerShell & SQLite データ同期システム - テスト結果</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background-color: #f0f0f0; padding: 20px; border-radius: 5px; }
        .summary { margin: 20px 0; }
        .passed { color: green; }
        .failed { color: red; }
        .skipped { color: orange; }
        .test-details { margin-top: 20px; }
        .test-container { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .test-name { font-weight: bold; }
        .test-time { color: #666; font-size: 0.9em; }
        .error-message { background-color: #ffebee; padding: 10px; margin: 10px 0; border-left: 4px solid #f44336; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PowerShell & SQLite データ同期システム</h1>
        <h2>テスト実行結果</h2>
        <p>実行日時: 2025年08月21日 10:39:41</p>
    </div>
    
    <div class="summary">
        <h3>実行サマリー</h3>
        <table>
            <tr><th>項目</th><th>件数</th></tr>
            <tr><td>総テスト数</td><td>31</td></tr>
            <tr><td class="passed">成功</td><td>23</td></tr>
            <tr><td class="failed">失敗</td><td>8</td></tr>
            <tr><td class="skipped">スキップ</td><td>0</td></tr>
            <tr><td>実行時間</td><td>00:10.574</td></tr>
        </table>
    </div>
    
    <div class="module-summary">
        <h3>モジュール別実行結果</h3>
        <table>
            <tr><th>モジュール</th><th>総数</th><th>成功</th><th>失敗</th><th>スキップ</th><th>実行時間</th></tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>23</td>
                <td class="passed">23</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:05.065</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>8</td>
                <td class="passed">0</td>
                <td class="failed">8</td>
                <td class="skipped">0</td>
                <td>00:04.142</td>
            </tr>        </table>
    </div>    <div class="test-details">
        <h3>失敗したテスト</h3>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 出力フィルタリング機能 - 全ての同期アクションが有効な場合、フィルタリングなしで出力される</div>
            <div class="test-time">実行時間: 00:03.469</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                SQLite3 CSV出力の実行に失敗しました: sqlite3 CSV出力エラー (終了コード: 1): Error: in prepare, no such table: sync_result
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 出力フィルタリング機能 - ADDアクションのみ有効な場合、新規作成のみ出力される</div>
            <div class="test-time">実行時間: 00:00.085</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 出力フィルタリング機能 - KEEPアクションのみ無効な場合、変更なし以外が出力される</div>
            <div class="test-time">実行時間: 00:00.099</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 出力フィルタリング機能 - 全ての同期アクションが無効な場合、空の結果が出力される</div>
            <div class="test-time">実行時間: 00:00.082</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 出力フィルタリング機能 - enabled設定がない場合、全レコードが出力される</div>
            <div class="test-time">実行時間: 00:00.097</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 履歴保存機能 - 履歴ディレクトリが存在しない場合、作成される</div>
            <div class="test-time">実行時間: 00:00.096</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] 履歴保存機能 - 出力ファイルが履歴ディレクトリにコピーされる</div>
            <div class="test-time">実行時間: 00:00.107</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。
            </div>
        </div>        <div class="test-container">
            <div class="test-name">[Invoke-CsvExport] [-] エラーハンドリング - 出力ファイルパスが指定されていない場合、例外がスローされる</div>
            <div class="test-time">実行時間: 00:00.103</div>
            <div class="error-message">
                <strong>エラーメッセージ:</strong><br>
                Expected an exception with message like '*出力ファイルパスが指定されていません*' to be thrown, but the message was '設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。'. from /workspaces/ps-sqlite/scripts/modules/Utils/Infrastructure/ConfigurationUtils.psm1:21 char:9<br>    +         throw "設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。"<br>    +         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
            </div>
        </div></div>    <div class="test-details">
        <h3>すべてのテスト結果</h3>
        <table>
            <tr>
                <th>モジュール</th>
                <th>分類</th>
                <th>テスト名</th>
                <th>結果</th>
                <th>実行時間</th>
                <th>詳細</th>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - 基本動作</td>
                <td>有効なパラメータで正常に処理を完了する</td>
                <td class="passed">Passed</td>
                <td>00:00.826</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - 基本動作</td>
                <td>DatabasePathが未指定の場合、デフォルトパスを設定する</td>
                <td class="passed">Passed</td>
                <td>00:00.230</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - 基本動作</td>
                <td>設定ファイル読み込みが正常に実行される</td>
                <td class="passed">Passed</td>
                <td>00:00.322</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - 外部依存関係検証</td>
                <td>SQLite3コマンドが利用可能な場合、成功メッセージをログ出力する</td>
                <td class="passed">Passed</td>
                <td>00:00.269</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - 外部依存関係検証</td>
                <td>SQLite3コマンドが見つからない場合、エラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.185</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ファイルパス解決</td>
                <td>実ファイルを使ったパス解決テスト</td>
                <td class="passed">Passed</td>
                <td>00:00.286</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ファイルパス解決</td>
                <td>パラメータで指定されたパスが優先される</td>
                <td class="passed">Passed</td>
                <td>00:00.223</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ファイルパス解決</td>
                <td>パラメータが未指定の場合、設定ファイルから解決される</td>
                <td class="passed">Passed</td>
                <td>00:00.219</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ファイル存在チェック</td>
                <td>解決されたパスでファイル存在チェックが実行される</td>
                <td class="passed">Passed</td>
                <td>00:00.222</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ファイル存在チェック</td>
                <td>ファイル存在チェックでエラーが発生した場合、例外をスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.218</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ログ出力</td>
                <td>処理パラメータが適切にログ出力される</td>
                <td class="passed">Passed</td>
                <td>00:00.230</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation 関数 - ログ出力</td>
                <td>各処理段階で適切な進捗ログが出力される</td>
                <td class="passed">Passed</td>
                <td>00:00.286</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ファイル存在チェック（Test-ResolvedFilePaths経由）</td>
                <td>すべてのファイルが存在する場合、正常に完了する</td>
                <td class="passed">Passed</td>
                <td>00:00.275</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ファイル存在チェック（Test-ResolvedFilePaths経由）</td>
                <td>提供データファイルが存在しない場合、エラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.163</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ファイル存在チェック（Test-ResolvedFilePaths経由）</td>
                <td>現在データファイルが存在しない場合、エラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.129</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ファイル存在チェック（Test-ResolvedFilePaths経由）</td>
                <td>出力ディレクトリが存在しない場合、エラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.149</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] 関数のエクスポート確認</td>
                <td>Invoke-ConfigValidation 関数がエクスポートされている</td>
                <td class="passed">Passed</td>
                <td>00:00.077</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>空のProjectRootパラメータでエラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.084</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>無効なProjectRootパスでエラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.076</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>設定検証でエラーが発生した場合、適切にエラーをスローする</td>
                <td class="passed">Passed</td>
                <td>00:00.094</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>日本語データを含むファイルパスの処理</td>
                <td class="passed">Passed</td>
                <td>00:00.187</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>複数のパラメータが同時に指定された場合の優先順位</td>
                <td class="passed">Passed</td>
                <td>00:00.154</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] エラーハンドリングとエッジケース</td>
                <td>非常に長いファイルパスでも正常に処理される</td>
                <td class="passed">Passed</td>
                <td>00:00.147</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 出力フィルタリング機能</td>
                <td>全ての同期アクションが有効な場合、フィルタリングなしで出力される</td>
                <td class="failed">Failed</td>
                <td>00:03.469</td>
                <td>SQLite3 CSV出力の実行に失敗しました: sqlite3 CSV出力エラー (終了コード: 1): Error: in prepare, no such table: sync_result</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 出力フィルタリング機能</td>
                <td>ADDアクションのみ有効な場合、新規作成のみ出力される</td>
                <td class="failed">Failed</td>
                <td>00:00.085</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 出力フィルタリング機能</td>
                <td>KEEPアクションのみ無効な場合、変更なし以外が出力される</td>
                <td class="failed">Failed</td>
                <td>00:00.099</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 出力フィルタリング機能</td>
                <td>全ての同期アクションが無効な場合、空の結果が出力される</td>
                <td class="failed">Failed</td>
                <td>00:00.082</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 出力フィルタリング機能</td>
                <td>enabled設定がない場合、全レコードが出力される</td>
                <td class="failed">Failed</td>
                <td>00:00.097</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 履歴保存機能</td>
                <td>履歴ディレクトリが存在しない場合、作成される</td>
                <td class="failed">Failed</td>
                <td>00:00.096</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] 履歴保存機能</td>
                <td>出力ファイルが履歴ディレクトリにコピーされる</td>
                <td class="failed">Failed</td>
                <td>00:00.107</td>
                <td>設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。</td>
            </tr>            <tr>
                <td>Invoke-CsvExport</td>
                <td>[-] エラーハンドリング</td>
                <td>出力ファイルパスが指定されていない場合、例外がスローされる</td>
                <td class="failed">Failed</td>
                <td>00:00.103</td>
                <td>Expected an exception with message like '*出力ファイルパスが指定されていません*' to be thrown, but the message was '設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。'. from /workspaces/ps-sqlite/scripts/modules/Utils/Infrastructure/ConfigurationUtils.psm1:21 char:9
    +         throw "設定がまだ読み込まれていません。最初にConfigPathを指定して呼び出す必要があります。"
    +         ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</td>
            </tr>        </table>
    </div></body>
</html>
