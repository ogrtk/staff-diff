<!DOCTYPE html>
<html>
<head>
    <title>PowerShell & SQLite ãƒ‡ãƒ¼ã‚¿åŒæœŸã‚·ã‚¹ãƒ†ãƒ  - ãƒ†ã‚¹ãƒˆçµæœ</title>
    <meta charset="utf-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { background-color: #f0f0f0; padding: 20px; border-radius: 5px; }
        .summary { margin: 20px 0; }
        .passed { color: green; }
        .failed { color: red; }
        .skipped { color: orange; }
        .test-details { margin-top: 20px; }
        .test-container { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .test-name { font-weight: bold; }
        .test-time { color: #666; font-size: 0.9em; }
        .error-message { background-color: #ffebee; padding: 10px; margin: 10px 0; border-left: 4px solid #f44336; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <div class="header">
        <h1>PowerShell & SQLite ãƒ‡ãƒ¼ã‚¿åŒæœŸã‚·ã‚¹ãƒ†ãƒ </h1>
        <h2>ãƒ†ã‚¹ãƒˆå®Ÿè¡Œçµæœ</h2>
        <p>å®Ÿè¡Œæ—¥æ™‚: 2025å¹´08æœˆ20æ—¥ 23:24:29</p>
    </div>
    
    <div class="summary">
        <h3>å®Ÿè¡Œã‚µãƒãƒªãƒ¼</h3>
        <table>
            <tr><th>é …ç›®</th><th>ä»¶æ•°</th></tr>
            <tr><td>ç·ãƒ†ã‚¹ãƒˆæ•°</td><td>23</td></tr>
            <tr><td class="passed">æˆåŠŸ</td><td>23</td></tr>
            <tr><td class="failed">å¤±æ•—</td><td>0</td></tr>
            <tr><td class="skipped">ã‚¹ã‚­ãƒƒãƒ—</td><td>0</td></tr>
            <tr><td>å®Ÿè¡Œæ™‚é–“</td><td>00:06.544</td></tr>
        </table>
    </div>
    
    <div class="module-summary">
        <h3>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ¥å®Ÿè¡Œçµæœ</h3>
        <table>
            <tr><th>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</th><th>ç·æ•°</th><th>æˆåŠŸ</th><th>å¤±æ•—</th><th>ã‚¹ã‚­ãƒƒãƒ—</th><th>å®Ÿè¡Œæ™‚é–“</th></tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>23</td>
                <td class="passed">23</td>
                <td class="failed">0</td>
                <td class="skipped">0</td>
                <td>00:05.438</td>
            </tr>        </table>
    </div>    <div class="test-details">
        <h3>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆçµæœ</h3>
        <table>
            <tr>
                <th>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</th>
                <th>åˆ†é¡</th>
                <th>ãƒ†ã‚¹ãƒˆå</th>
                <th>çµæœ</th>
                <th>å®Ÿè¡Œæ™‚é–“</th>
                <th>è©³ç´°</th>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - åŸºæœ¬å‹•ä½œ</td>
                <td>æœ‰åŠ¹ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ­£å¸¸ã«å‡¦ç†ã‚’å®Œäº†ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.868</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - åŸºæœ¬å‹•ä½œ</td>
                <td>DatabasePathãŒæœªæŒ‡å®šã®å ´åˆã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.255</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - åŸºæœ¬å‹•ä½œ</td>
                <td>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ãŒæ­£å¸¸ã«å®Ÿè¡Œã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.283</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - å¤–éƒ¨ä¾å­˜é–¢ä¿‚æ¤œè¨¼</td>
                <td>SQLite3ã‚³ãƒãƒ³ãƒ‰ãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆã€æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ­ã‚°å‡ºåŠ›ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.256</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - å¤–éƒ¨ä¾å­˜é–¢ä¿‚æ¤œè¨¼</td>
                <td>SQLite3ã‚³ãƒãƒ³ãƒ‰ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.218</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹è§£æ±º</td>
                <td>å®Ÿãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ã£ãŸãƒ‘ã‚¹è§£æ±ºãƒ†ã‚¹ãƒˆ</td>
                <td class="passed">Passed</td>
                <td>00:00.314</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹è§£æ±º</td>
                <td>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ãŒå„ªå…ˆã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.218</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹è§£æ±º</td>
                <td>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæœªæŒ‡å®šã®å ´åˆã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è§£æ±ºã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.237</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯</td>
                <td>è§£æ±ºã•ã‚ŒãŸãƒ‘ã‚¹ã§ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.234</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯</td>
                <td>ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€ä¾‹å¤–ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.160</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ­ã‚°å‡ºåŠ›</td>
                <td>å‡¦ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒé©åˆ‡ã«ãƒ­ã‚°å‡ºåŠ›ã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.239</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] Invoke-ConfigValidation é–¢æ•° - ãƒ­ã‚°å‡ºåŠ›</td>
                <td>å„å‡¦ç†æ®µéšã§é©åˆ‡ãªé€²æ—ãƒ­ã‚°ãŒå‡ºåŠ›ã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.300</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆTest-ResolvedFilePathsçµŒç”±ï¼‰</td>
                <td>ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€æ­£å¸¸ã«å®Œäº†ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.265</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆTest-ResolvedFilePathsçµŒç”±ï¼‰</td>
                <td>æä¾›ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.240</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆTest-ResolvedFilePathsçµŒç”±ï¼‰</td>
                <td>ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.257</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ãƒã‚§ãƒƒã‚¯ï¼ˆTest-ResolvedFilePathsçµŒç”±ï¼‰</td>
                <td>å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã€ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.176</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] é–¢æ•°ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆç¢ºèª</td>
                <td>Invoke-ConfigValidation é–¢æ•°ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.088</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>ç©ºã®ProjectRootãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.106</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>ç„¡åŠ¹ãªProjectRootãƒ‘ã‚¹ã§ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.095</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>è¨­å®šæ¤œè¨¼ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã€é©åˆ‡ã«ã‚¨ãƒ©ãƒ¼ã‚’ã‚¹ãƒ­ãƒ¼ã™ã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.101</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>æ—¥æœ¬èªãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã®å‡¦ç†</td>
                <td class="passed">Passed</td>
                <td>00:00.186</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒåŒæ™‚ã«æŒ‡å®šã•ã‚ŒãŸå ´åˆã®å„ªå…ˆé †ä½</td>
                <td class="passed">Passed</td>
                <td>00:00.173</td>
                <td></td>
            </tr>            <tr>
                <td>Invoke-ConfigValidation</td>
                <td>[+] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹</td>
                <td>éå¸¸ã«é•·ã„ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã§ã‚‚æ­£å¸¸ã«å‡¦ç†ã•ã‚Œã‚‹</td>
                <td class="passed">Passed</td>
                <td>00:00.155</td>
                <td></td>
            </tr>        </table>
    </div>    <div class="coverage-summary" style="margin-top: 30px; border-top: 3px solid #2196F3; padding-top: 20px;">
        <h2 style="color: #2196F3; border-bottom: 2px solid #2196F3; padding-bottom: 10px;">ğŸ“Š ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆ</h2>
        <table>
            <tr><th>é …ç›®</th><th>å€¤</th></tr>
            <tr><td>ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡</td><td>10.33%</td></tr>
            <tr><td>å®Ÿè¡Œã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰</td><td>50</td></tr>
            <tr><td>è§£æã•ã‚ŒãŸã‚³ãƒãƒ³ãƒ‰</td><td>484</td></tr>
            <tr><td>æœªå®Ÿè¡Œã®ã‚³ãƒãƒ³ãƒ‰</td><td>434</td></tr>
        </table>
        <p style="font-size: 0.9em; color: #666;">â€» Pester 5.xã§ã¯ã€Œã‚³ãƒãƒ³ãƒ‰ã€å˜ä½ã§æ¸¬å®šï¼ˆè¡Œå˜ä½ã§ã¯ãªã„ï¼‰</p>
    </div>
    
    <div class="file-coverage">
        <h3 style="color: #2196F3;">ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥ã‚«ãƒãƒ¬ãƒƒã‚¸è©³ç´°</h3>
        <table>
            <tr>
                <th>ãƒ•ã‚¡ã‚¤ãƒ«</th>
                <th>è§£æã‚³ãƒãƒ³ãƒ‰æ•°</th>
                <th>å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰æ•°</th>
                <th>æœªå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰æ•°</th>
                <th>ã‚«ãƒãƒ¬ãƒƒã‚¸ç‡</th>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-ConfigValidation.psm1</td>
                <td>51</td>
                <td>50</td>
                <td>1</td>
                <td>98.04%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>26</td>
                <td>0</td>
                <td>26</td>
                <td>0%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>174</td>
                <td>0</td>
                <td>174</td>
                <td>0%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>68</td>
                <td>0</td>
                <td>68</td>
                <td>0%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>95</td>
                <td>0</td>
                <td>95</td>
                <td>0%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>50</td>
                <td>0</td>
                <td>50</td>
                <td>0%</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>20</td>
                <td>0</td>
                <td>20</td>
                <td>0%</td>
            </tr>        </table>
    </div>    <div class="missed-commands">
        <h3 style="color: #ff9800;">âš ï¸ æœªå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰è©³ç´°ï¼ˆå…¨ 434 å€‹ï¼‰</h3>
        <table>
            <tr>
                <th>ãƒ•ã‚¡ã‚¤ãƒ«</th>
                <th>è¡Œç•ªå·</th>
                <th>ã‚³ãƒãƒ³ãƒ‰</th>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-ConfigValidation.psm1</td>
                <td>103</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Invoke-ConfigValidation'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>22</td>
                <td style="font-family: monospace; font-size: 0.9em;">$filePathConfig = Get-FilePathConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>25</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ([string]::IsNullOrEmpty($OutputFilePath)) {
        throw "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>26</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category External -Operation "åŒæœŸçµæœCSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†" -Context @{
        "DatabasePath"   = $DatabasePath
        "OutputFilePath" = $OutputFilePath
    } -ScriptBlock {
        # ã‚¯ã‚¨ãƒªæº–å‚™
        $syncResultKeys = Get-TableKeyColumns -TableName "sync_result"
        $firstKey = if ($syncResultKeys -is [array]) { $syncResultKeys[0] } else { $syncResultKeys }
        $query = New-SelectSql -TableName "sync_result" -OrderBy $firstKey

        # ã‚¯ã‚¨ãƒªå®Ÿè¡Œ
        $recordCount = Invoke-SqliteCsvExport -DatabasePath $DatabasePath -Query $query -OutputPath $OutputFilePath

        Write-SystemLog "åŒæœŸçµæœã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã—ãŸ: $OutputFilePath ($recordCount ä»¶)" -Level "Success"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>31</td>
                <td style="font-family: monospace; font-size: 0.9em;">"DatabasePath" = $DatabasePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>32</td>
                <td style="font-family: monospace; font-size: 0.9em;">"OutputFilePath" = $OutputFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys = Get-TableKeyColumns -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($syncResultKeys -is [array]) { $syncResultKeys[0] } else { $syncResultKeys }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys[0]</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>37</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = New-SelectSql -TableName "sync_result" -OrderBy $firstKey</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>40</td>
                <td style="font-family: monospace; font-size: 0.9em;">$recordCount = Invoke-SqliteCsvExport -DatabasePath $DatabasePath -Query $query -OutputPath $OutputFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>42</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "åŒæœŸçµæœã‚’CSVãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã—ãŸ: $OutputFilePath ($recordCount ä»¶)" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>46</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category External -Operation "å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›" -ScriptBlock {
        # å±¥æ­´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
        if (-not (Test-Path $filePathConfig.output_history_directory)) {
            New-Item -ItemType Directory -Path $filePathConfig.output_history_directory -Force | Out-Null
            Write-SystemLog "å±¥æ­´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $($filePathConfig.output_history_directory)" -Level "Success"
        }
        # å±¥æ­´ä¿å­˜ãƒ‘ã‚¹æº–å‚™ï¼ˆOutputFilePathã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä½¿ç”¨ï¼‰
        $baseFileName = Split-Path -Leaf $OutputFilePath
        $historyFileName = New-HistoryFileName -BaseFileName $baseFileName
        $historyPath = Join-Path $filePathConfig.output_history_directory $historyFileName
        Copy-Item -Path $OutputFilePath -Destination $historyPath -Force

        Write-SystemLog "åŒæœŸçµæœã‚’å±¥æ­´ãƒ•ã‚©ãƒ«ãƒ€ã«å‡ºåŠ›ã—ã¾ã—ãŸ: $historyPath" -Level "Success"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>48</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-Path $filePathConfig.output_history_directory)) {
            New-Item -ItemType Directory -Path $filePathConfig.output_history_directory -Force | Out-Null
            Write-SystemLog "å±¥æ­´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $($filePathConfig.output_history_directory)" -Level "Success"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>48</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $filePathConfig.output_history_directory</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>49</td>
                <td style="font-family: monospace; font-size: 0.9em;">New-Item -ItemType Directory -Path $filePathConfig.output_history_directory -Force</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>49</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-Null</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>50</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å±¥æ­´ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $($filePathConfig.output_history_directory)" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>50</td>
                <td style="font-family: monospace; font-size: 0.9em;">$filePathConfig.output_history_directory</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>53</td>
                <td style="font-family: monospace; font-size: 0.9em;">$baseFileName = Split-Path -Leaf $OutputFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>54</td>
                <td style="font-family: monospace; font-size: 0.9em;">$historyFileName = New-HistoryFileName -BaseFileName $baseFileName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>55</td>
                <td style="font-family: monospace; font-size: 0.9em;">$historyPath = Join-Path $filePathConfig.output_history_directory $historyFileName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>56</td>
                <td style="font-family: monospace; font-size: 0.9em;">Copy-Item -Path $OutputFilePath -Destination $historyPath -Force</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "åŒæœŸçµæœã‚’å±¥æ­´ãƒ•ã‚©ãƒ«ãƒ€ã«å‡ºåŠ›ã—ã¾ã—ãŸ: $historyPath" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvExport.psm1</td>
                <td>62</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Invoke-CsvExport'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">$filePathConfig = Get-FilePathConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">$DataType</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>32</td>
                <td style="font-family: monospace; font-size: 0.9em;">@{
                TableName        = "provided_data"
                HistoryDirectory = $filePathConfig.provided_data_history_directory
                Description      = "æä¾›ãƒ‡ãƒ¼ã‚¿"
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>33</td>
                <td style="font-family: monospace; font-size: 0.9em;">TableName = "provided_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>34</td>
                <td style="font-family: monospace; font-size: 0.9em;">HistoryDirectory = $filePathConfig.provided_data_history_directory</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">Description = "æä¾›ãƒ‡ãƒ¼ã‚¿"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>39</td>
                <td style="font-family: monospace; font-size: 0.9em;">@{
                TableName        = "current_data" 
                HistoryDirectory = $filePathConfig.current_data_history_directory
                Description      = "ç¾åœ¨ãƒ‡ãƒ¼ã‚¿"
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>40</td>
                <td style="font-family: monospace; font-size: 0.9em;">TableName = "current_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">HistoryDirectory = $filePathConfig.current_data_history_directory</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>42</td>
                <td style="font-family: monospace; font-size: 0.9em;">Description = "ç¾åœ¨ãƒ‡ãƒ¼ã‚¿"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>47</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "$($config.Description)ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>47</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config.Description</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>48</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-CsvImportMain -CsvPath $CsvPath -DatabasePath $DatabasePath -TableName $config.TableName -HistoryDirectory $config.HistoryDirectory -FileTypeDescription $config.Description</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>49</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "$($config.Description)ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>49</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config.Description</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>71</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-Path $CsvPath)) {
        throw "CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $CsvPath"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>71</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $CsvPath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>72</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $CsvPath"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>75</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å‡¦ç†å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ« ${FileTypeDescription}CSV: $CsvPath" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>78</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category External -Operation "å±¥æ­´ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼" -ScriptBlock {
        return Copy-InputFileToHistory -SourceFilePath $CsvPath -HistoryDirectory $HistoryDirectory
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>79</td>
                <td style="font-family: monospace; font-size: 0.9em;">return Copy-InputFileToHistory -SourceFilePath $CsvPath -HistoryDirectory $HistoryDirectory</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>83</td>
                <td style="font-family: monospace; font-size: 0.9em;">$processingCsvPath = $CsvPath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>84</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempHeaderFile = $null</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>86</td>
                <td style="font-family: monospace; font-size: 0.9em;">$formatConfig = Get-CsvFormatConfig -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>87</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($formatConfig.has_header -eq $false) {
        $tempHeaderFile = Invoke-WithErrorHandling -Category External -Operation "ãƒ˜ãƒƒãƒ€ä»˜ãä¸€æ™‚CSVãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ" -ScriptBlock {
            New-TempCsvWithHeader -CsvPath $CsvPath -TableName $TableName
        }
        $processingCsvPath = $tempHeaderFile
        Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå®Œäº†: $processingCsvPath" -Level "Info"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>88</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempHeaderFile = Invoke-WithErrorHandling -Category External -Operation "ãƒ˜ãƒƒãƒ€ä»˜ãä¸€æ™‚CSVãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ" -ScriptBlock {
            New-TempCsvWithHeader -CsvPath $CsvPath -TableName $TableName
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>89</td>
                <td style="font-family: monospace; font-size: 0.9em;">New-TempCsvWithHeader -CsvPath $CsvPath -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>91</td>
                <td style="font-family: monospace; font-size: 0.9em;">$processingCsvPath = $tempHeaderFile</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>92</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ããƒ•ã‚¡ã‚¤ãƒ«ä½œæˆå®Œäº†: $processingCsvPath" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>96</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvCleanupScript = {
        if ($tempHeaderFile -and (Test-Path $tempHeaderFile)) {
            Remove-Item $tempHeaderFile -Force -ErrorAction SilentlyContinue
            Write-SystemLog "ä¸€æ™‚ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempHeaderFile" -Level "Info"
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>97</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($tempHeaderFile -and (Test-Path $tempHeaderFile)) {
            Remove-Item $tempHeaderFile -Force -ErrorAction SilentlyContinue
            Write-SystemLog "ä¸€æ™‚ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempHeaderFile" -Level "Info"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>97</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $tempHeaderFile</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>98</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $tempHeaderFile -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>99</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ä¸€æ™‚ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempHeaderFile" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>104</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ¤œè¨¼é–‹å§‹" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>105</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category System -Operation "CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ¤œè¨¼" -CleanupScript $csvCleanupScript -ScriptBlock {
        if (-not (Test-CsvFormat -CsvPath $processingCsvPath -TableName $TableName)) {
            throw "CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ"
        }    
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>106</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-CsvFormat -CsvPath $processingCsvPath -TableName $TableName)) {
            throw "CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>106</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-CsvFormat -CsvPath $processingCsvPath -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>107</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "CSVãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®æ¤œè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>112</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†é–‹å§‹" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>115</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvData = Import-CsvWithFormat -CsvPath $processingCsvPath -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>116</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not $csvData -or $csvData.Count -eq 0) {
        Write-SystemLog "ç©ºã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãŸã‚ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™" -Level "Info"
        $statistics = @{
            TotalCount    = 0
            FilteredCount = 0
            ExcludedCount = 0
        }
    }
    else {
        $statistics = Invoke-WithErrorHandling -Category External -Operation "ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†" -CleanupScript $csvCleanupScript -ScriptBlock {
            Invoke-Filtering -DatabasePath $DatabasePath -TableName $TableName -CsvFilePath $processingCsvPath -ShowStatistics:$true
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>117</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ç©ºã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ãŸã‚ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>118</td>
                <td style="font-family: monospace; font-size: 0.9em;">$statistics = @{
            TotalCount    = 0
            FilteredCount = 0
            ExcludedCount = 0
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>119</td>
                <td style="font-family: monospace; font-size: 0.9em;">TotalCount = 0</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>120</td>
                <td style="font-family: monospace; font-size: 0.9em;">FilteredCount = 0</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>121</td>
                <td style="font-family: monospace; font-size: 0.9em;">ExcludedCount = 0</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>125</td>
                <td style="font-family: monospace; font-size: 0.9em;">$statistics = Invoke-WithErrorHandling -Category External -Operation "ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‡¦ç†" -CleanupScript $csvCleanupScript -ScriptBlock {
            Invoke-Filtering -DatabasePath $DatabasePath -TableName $TableName -CsvFilePath $processingCsvPath -ShowStatistics:$true
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>126</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-Filtering -DatabasePath $DatabasePath -TableName $TableName -CsvFilePath $processingCsvPath -ShowStatistics:$true</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>131</td>
                <td style="font-family: monospace; font-size: 0.9em;">& $csvCleanupScript</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>133</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "${FileTypeDescription}CSVã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚å‡¦ç†ä»¶æ•°: $($statistics.FilteredCount) / èª­ã¿è¾¼ã¿ä»¶æ•°: $($statistics.TotalCount)" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>133</td>
                <td style="font-family: monospace; font-size: 0.9em;">$statistics.FilteredCount</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>133</td>
                <td style="font-family: monospace; font-size: 0.9em;">$statistics.TotalCount</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>146</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ãä¸€æ™‚CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã€‚å…ƒãƒ•ã‚¡ã‚¤ãƒ«: $CsvPath (ãƒ†ãƒ¼ãƒ–ãƒ«: $TableName)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>150</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempDir = [System.IO.Path]::GetTempPath()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>151</td>
                <td style="font-family: monospace; font-size: 0.9em;">$baseFileName = [System.IO.Path]::GetFileNameWithoutExtension($CsvPath)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>152</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempPattern = "${baseFileName}_with_header_*.csv"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>153</td>
                <td style="font-family: monospace; font-size: 0.9em;">$orphanFiles = Get-ChildItem -Path $tempDir -Filter $tempPattern -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>155</td>
                <td style="font-family: monospace; font-size: 0.9em;">$orphanFiles</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>157</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($file.CreationTime -lt (Get-Date).AddHours(-1)) {
                Remove-Item $file.FullName -Force -ErrorAction SilentlyContinue
                Write-SystemLog "å¤ã„ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $($file.FullName)" -Level "Info"
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>157</td>
                <td style="font-family: monospace; font-size: 0.9em;">Get-Date</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>158</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $file.FullName -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>159</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å¤ã„ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $($file.FullName)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>159</td>
                <td style="font-family: monospace; font-size: 0.9em;">$file.FullName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>164</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å¤ã„ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­ã«ã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -Level "Warning"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>164</td>
                <td style="font-family: monospace; font-size: 0.9em;">$_.Exception.Message</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>168</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableColumns = Get-CsvColumns -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>170</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not $tableColumns -or $tableColumns.Count -eq 0) {
        throw "ãƒ†ãƒ¼ãƒ–ãƒ« '$TableName' ã®CSVã‚«ãƒ©ãƒ å®šç¾©ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>171</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "ãƒ†ãƒ¼ãƒ–ãƒ« '$TableName' ã®CSVã‚«ãƒ©ãƒ å®šç¾©ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>174</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ç”Ÿæˆã™ã‚‹ãƒ˜ãƒƒãƒ€ãƒ¼: $($tableColumns -join ', ')" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>174</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableColumns -join ', '</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>177</td>
                <td style="font-family: monospace; font-size: 0.9em;">$baseFileName = [System.IO.Path]::GetFileNameWithoutExtension($CsvPath)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>178</td>
                <td style="font-family: monospace; font-size: 0.9em;">$extension = [System.IO.Path]::GetExtension($CsvPath)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>179</td>
                <td style="font-family: monospace; font-size: 0.9em;">$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>180</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempFileName = "${baseFileName}_with_header_${timestamp}${extension}"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>181</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempPath = Join-Path ([System.IO.Path]::GetTempPath()) $tempFileName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>181</td>
                <td style="font-family: monospace; font-size: 0.9em;">[System.IO.Path]::GetTempPath()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>183</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: $tempPath" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>185</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $tempPath) {
        Remove-Item $tempPath -Force -ErrorAction SilentlyContinue
        Write-SystemLog "æ—¢å­˜ã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempPath" -Level "Info"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>186</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $tempPath -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>187</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ—¢å­˜ã®ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempPath" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>191</td>
                <td style="font-family: monospace; font-size: 0.9em;">$formatConfig = Get-CsvFormatConfig -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>192</td>
                <td style="font-family: monospace; font-size: 0.9em;">$encoding = ConvertTo-PowerShellEncoding -EncodingName $formatConfig.encoding</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>195</td>
                <td style="font-family: monospace; font-size: 0.9em;">$headerLine = $tableColumns -join $formatConfig.delimiter</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>198</td>
                <td style="font-family: monospace; font-size: 0.9em;">$headerLine</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>198</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempPath -Encoding $encoding -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>201</td>
                <td style="font-family: monospace; font-size: 0.9em;">$formatConfig.newline.ToUpper()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>202</td>
                <td style="font-family: monospace; font-size: 0.9em;">"`n"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>202</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempPath -Encoding $encoding -Append -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>203</td>
                <td style="font-family: monospace; font-size: 0.9em;">"`r"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>203</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempPath -Encoding $encoding -Append -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>204</td>
                <td style="font-family: monospace; font-size: 0.9em;">"`r`n"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>204</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempPath -Encoding $encoding -Append -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>208</td>
                <td style="font-family: monospace; font-size: 0.9em;">$originalContent = Get-Content -Path $CsvPath -Encoding $encoding -Raw</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>209</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($originalContent) {
        $originalContent | Out-File -FilePath $tempPath -Encoding $encoding -Append -NoNewline
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>210</td>
                <td style="font-family: monospace; font-size: 0.9em;">$originalContent</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>210</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempPath -Encoding $encoding -Append -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>213</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ãä¸€æ™‚CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆå®Œäº†: $tempPath" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>215</td>
                <td style="font-family: monospace; font-size: 0.9em;">return $tempPath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>233</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ç”¨ã«ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã¸CSVã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ: $TableName ($CsvFilePath)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>236</td>
                <td style="font-family: monospace; font-size: 0.9em;">Clear-Table -DatabasePath $DatabasePath -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>239</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvData = Import-Csv -Path $CsvFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>240</td>
                <td style="font-family: monospace; font-size: 0.9em;">$totalRecords = $csvData.Count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>241</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å‰: $totalRecords ä»¶" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>245</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempTableName = New-TempTableName -BaseTableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>247</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dropTempTableIfExistsSql = "DROP TABLE IF EXISTS $tempTableName;"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>248</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $dropTempTableIfExistsSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>249</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ—¢å­˜ã®ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤ã—ã¾ã—ãŸ: $tempTableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>251</td>
                <td style="font-family: monospace; font-size: 0.9em;">$createTempTableSql = New-CreateTempTableSql -BaseTableName $TableName -TempTableName $tempTableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>252</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $createTempTableSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>253</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ: $tempTableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>256</td>
                <td style="font-family: monospace; font-size: 0.9em;">Import-CsvToSqliteTable -CsvFilePath $CsvFilePath -DatabasePath $DatabasePath -TableName $tempTableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>257</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "CSVãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ: $tempTableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>260</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($TableName -eq "current_data") {
        $config = Get-DataSyncConfig
        if ($config.data_filters.current_data.output_excluded_as_keep.enabled -eq $true) {
            $excludedTableName = "${TableName}_excluded"
            Save-ExcludedDataForKeep -DatabasePath $DatabasePath -SourceTableName $tempTableName -ExcludedTableName $excludedTableName -FilterConfigTableName $TableName
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>261</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config = Get-DataSyncConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>262</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($config.data_filters.current_data.output_excluded_as_keep.enabled -eq $true) {
            $excludedTableName = "${TableName}_excluded"
            Save-ExcludedDataForKeep -DatabasePath $DatabasePath -SourceTableName $tempTableName -ExcludedTableName $excludedTableName -FilterConfigTableName $TableName
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>263</td>
                <td style="font-family: monospace; font-size: 0.9em;">$excludedTableName = "${TableName}_excluded"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>264</td>
                <td style="font-family: monospace; font-size: 0.9em;">Save-ExcludedDataForKeep -DatabasePath $DatabasePath -SourceTableName $tempTableName -ExcludedTableName $excludedTableName -FilterConfigTableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>269</td>
                <td style="font-family: monospace; font-size: 0.9em;">$whereClause = New-FilterWhereClause -TableName $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>270</td>
                <td style="font-family: monospace; font-size: 0.9em;">$filteredInsertSql = New-FilteredInsertSql -TargetTableName $TableName -SourceTableName $tempTableName -WhereClause $whereClause</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>271</td>
                <td style="font-family: monospace; font-size: 0.9em;">$statisticsSql = "SELECT COUNT(*) as filtered_count FROM $TableName;"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>272</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dropTempTableSql = "DROP TABLE $tempTableName;"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>274</td>
                <td style="font-family: monospace; font-size: 0.9em;">$filteringAndCleanupSql = @"
BEGIN TRANSACTION;
$filteredInsertSql
$statisticsSql
$dropTempTableSql
COMMIT;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>282</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Ÿè¡Œä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>283</td>
                <td style="font-family: monospace; font-size: 0.9em;">$result = Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $filteringAndCleanupSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>286</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($result -is [array] -and $result.Count -gt 0) { 
        # æœ€å¾Œã®çµ±è¨ˆã‚¯ã‚¨ãƒªã®çµæœã‚’å–å¾—
        [int]($result | Select-Object -Last 1)
    }
    else { 
        [int]$result 
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>288</td>
                <td style="font-family: monospace; font-size: 0.9em;">[int]($result | Select-Object -Last 1)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>288</td>
                <td style="font-family: monospace; font-size: 0.9em;">$result</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>288</td>
                <td style="font-family: monospace; font-size: 0.9em;">Select-Object -Last 1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>291</td>
                <td style="font-family: monospace; font-size: 0.9em;">[int]$result</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>295</td>
                <td style="font-family: monospace; font-size: 0.9em;">$indexSqls = New-CreateIndexSql -TableName $TableName -RecordCount $filteredCount</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>296</td>
                <td style="font-family: monospace; font-size: 0.9em;">$indexSqls</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>297</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $indexSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>301</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($ShowStatistics) {
        $whereClauseForDisplay = if ($whereClause) { $whereClause } else { "" }
        Show-FilteringStatistics -TableName $TableName -TotalCount $totalRecords -FilteredCount $filteredCount -WhereClause $whereClauseForDisplay
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>302</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($whereClause) { $whereClause } else { "" }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>302</td>
                <td style="font-family: monospace; font-size: 0.9em;">$whereClause</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>302</td>
                <td style="font-family: monospace; font-size: 0.9em;">""</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>303</td>
                <td style="font-family: monospace; font-size: 0.9em;">Show-FilteringStatistics -TableName $TableName -TotalCount $totalRecords -FilteredCount $filteredCount -WhereClause $whereClauseForDisplay</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>306</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "SQLãƒ™ãƒ¼ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å®Œäº†: $filteredCount ä»¶ã‚’ $TableName ã«æŒ¿å…¥" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>309</td>
                <td style="font-family: monospace; font-size: 0.9em;">return @{
        TotalCount    = $totalRecords
        FilteredCount = $filteredCount
        TableName     = $TableName
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>310</td>
                <td style="font-family: monospace; font-size: 0.9em;">TotalCount = $totalRecords</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>311</td>
                <td style="font-family: monospace; font-size: 0.9em;">FilteredCount = $filteredCount</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>312</td>
                <td style="font-family: monospace; font-size: 0.9em;">TableName = $TableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>330</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-Path $CsvFilePath)) {
        throw "CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $CsvFilePath"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>330</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $CsvFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>331</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "CSVãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: $CsvFilePath"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>335</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempCsvFile = [System.IO.Path]::GetTempFileName() + ".csv"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>336</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempSqlFile = [System.IO.Path]::GetTempFileName() + ".sql"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>340</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvContent = Get-Content -Path $CsvFilePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>341</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($csvContent.Count -gt 1) {
            # ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’é™¤ã„ãŸå†…å®¹ã‚’ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
            $csvContent[1..($csvContent.Count - 1)] | Out-File -FilePath $tempCsvFile -Encoding UTF8
            Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ: $(Split-Path -Leaf $tempCsvFile)" -Level "Info"
        }
        else {
            Write-SystemLog "CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿è¡ŒãŒã‚ã‚Šã¾ã›ã‚“: $CsvFilePath" -Level "Warning"
            return
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>343</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvContent[1..($csvContent.Count - 1)]</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>343</td>
                <td style="font-family: monospace; font-size: 0.9em;">$csvContent.Count - 1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>343</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempCsvFile -Encoding UTF8</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>344</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ãŸä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ: $(Split-Path -Leaf $tempCsvFile)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>344</td>
                <td style="font-family: monospace; font-size: 0.9em;">Split-Path -Leaf $tempCsvFile</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>347</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ‡ãƒ¼ã‚¿è¡ŒãŒã‚ã‚Šã¾ã›ã‚“: $CsvFilePath" -Level "Warning"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>352</td>
                <td style="font-family: monospace; font-size: 0.9em;">$normalizedTempCsvFile = $tempCsvFile -replace '\\', '/'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>353</td>
                <td style="font-family: monospace; font-size: 0.9em;">$normalizedDatabasePath = $DatabasePath -replace '\\', '/'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>355</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "SQLite .importå®Ÿè¡Œä¸­ - DB: $normalizedDatabasePath, CSV: $normalizedTempCsvFile, Table: $TableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>358</td>
                <td style="font-family: monospace; font-size: 0.9em;">$sqlCommands = @"
.mode csv
.import "$normalizedTempCsvFile" $TableName
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>362</td>
                <td style="font-family: monospace; font-size: 0.9em;">$sqlCommands</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>362</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempSqlFile -Encoding UTF8 -NoNewline</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>365</td>
                <td style="font-family: monospace; font-size: 0.9em;">$result = & sqlite3 $normalizedDatabasePath ".read $tempSqlFile" 2>&1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>367</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($LASTEXITCODE -ne 0) {
            throw "SQLite .importã«å¤±æ•— $result"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>368</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "SQLite .importã«å¤±æ•— $result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>373</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "SQLiteã¸ã®CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ: $($_.Exception.Message)"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>373</td>
                <td style="font-family: monospace; font-size: 0.9em;">$_.Exception.Message</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>377</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $tempSqlFile) {
            Remove-Item $tempSqlFile -Force -ErrorAction SilentlyContinue
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>378</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $tempSqlFile -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>380</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $tempCsvFile) {
            Remove-Item $tempCsvFile -Force -ErrorAction SilentlyContinue
            Write-SystemLog "ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤: $(Split-Path -Leaf $tempCsvFile)" -Level "Info"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>381</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $tempCsvFile -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>382</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤: $(Split-Path -Leaf $tempCsvFile)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>382</td>
                <td style="font-family: monospace; font-size: 0.9em;">Split-Path -Leaf $tempCsvFile</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-CsvImport.psm1</td>
                <td>387</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Invoke-CsvImport'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>21</td>
                <td style="font-family: monospace; font-size: 0.9em;">$cleanupScript = {
        try {
            # æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼
            if (Test-Path $DatabasePath) {
                $dbInfo = Get-Item $DatabasePath -ErrorAction SilentlyContinue
                if ($dbInfo) {
                    Write-SystemLog "æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $($dbInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($dbInfo.LastWriteTime)" -Level "Info"
                    
                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆåŸºæœ¬çš„ãªæ¤œè¨¼ï¼‰
                    if ($dbInfo.Length -eq 0) {
                        Write-SystemLog "ç©ºã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™" -Level "Warning"
                        Remove-Item $DatabasePath -Force -ErrorAction SilentlyContinue
                    }
                }
            }
            
            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å†ç¢ºèª
            $dbDir = Split-Path -Path $DatabasePath -Parent
            if (-not (Test-Path $dbDir)) {
                Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å†ä½œæˆã—ã¾ã™: $dbDir" -Level "Info"
                New-Item -ItemType Directory -Path $dbDir -Force -ErrorAction SilentlyContinue | Out-Null
            }
        }
        catch {
            Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­ã«ã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -Level "Warning"
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>24</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $DatabasePath) {
                $dbInfo = Get-Item $DatabasePath -ErrorAction SilentlyContinue
                if ($dbInfo) {
                    Write-SystemLog "æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $($dbInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($dbInfo.LastWriteTime)" -Level "Info"
                    
                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆåŸºæœ¬çš„ãªæ¤œè¨¼ï¼‰
                    if ($dbInfo.Length -eq 0) {
                        Write-SystemLog "ç©ºã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™" -Level "Warning"
                        Remove-Item $DatabasePath -Force -ErrorAction SilentlyContinue
                    }
                }
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>25</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dbInfo = Get-Item $DatabasePath -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>26</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($dbInfo) {
                    Write-SystemLog "æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $($dbInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($dbInfo.LastWriteTime)" -Level "Info"
                    
                    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ï¼ˆåŸºæœ¬çš„ãªæ¤œè¨¼ï¼‰
                    if ($dbInfo.Length -eq 0) {
                        Write-SystemLog "ç©ºã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™" -Level "Warning"
                        Remove-Item $DatabasePath -Force -ErrorAction SilentlyContinue
                    }
                }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $($dbInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($dbInfo.LastWriteTime)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dbInfo.Length</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dbInfo.LastWriteTime</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($dbInfo.Length -eq 0) {
                        Write-SystemLog "ç©ºã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™" -Level "Warning"
                        Remove-Item $DatabasePath -Force -ErrorAction SilentlyContinue
                    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>31</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ç©ºã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œå‡ºã€å‰Šé™¤ã—ã¦å†ä½œæˆã—ã¾ã™" -Level "Warning"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>32</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item $DatabasePath -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>38</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dbDir = Split-Path -Path $DatabasePath -Parent</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>39</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-Path $dbDir)) {
                Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å†ä½œæˆã—ã¾ã™: $dbDir" -Level "Info"
                New-Item -ItemType Directory -Path $dbDir -Force -ErrorAction SilentlyContinue | Out-Null
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>39</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $dbDir</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>40</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚å†ä½œæˆã—ã¾ã™: $dbDir" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">New-Item -ItemType Directory -Path $dbDir -Force -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-Null</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>45</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­ã«ã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -Level "Warning"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>45</td>
                <td style="font-family: monospace; font-size: 0.9em;">$_.Exception.Message</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>49</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category External -Operation "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–å‡¦ç†" -CleanupScript $cleanupScript -Context @{
        "DatabasePath" = $DatabasePath
    } -ScriptBlock {
        
        # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ
        $dbDir = Split-Path -Path $DatabasePath -Parent
        if (-not (Test-Path $dbDir)) {
            Invoke-WithErrorHandling -ScriptBlock {
                New-Item -ItemType Directory -Path $dbDir -Force | Out-Null
                Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $dbDir" -Level "Info"
            } -Category External -Operation "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" -Context @{"ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" = $dbDir; "æ“ä½œç¨®åˆ¥" = "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" } -CleanupScript {
                # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œç‰¹æœ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                if (Test-Path $dbDir -ErrorAction SilentlyContinue) {
                    $fileInfo = Get-Item $dbDir -ErrorAction SilentlyContinue
                    if ($fileInfo) {
                        Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"
                    }
                }
            }
        }
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚’é–‹å§‹ã—ã¾ã™..." -Level "Info"
        
        # 1. SQLæ–‡ã®ç”Ÿæˆ
        $sqlStatements = New-DatabaseSchema
        
        # 2. SQLæ–‡ã®å®Ÿè¡Œï¼ˆå¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ä¾å­˜ï¼‰
        Invoke-WithErrorHandling -ScriptBlock {
            Invoke-DatabaseInitializationInternal -DatabasePath $DatabasePath -SqlStatements $sqlStatements
        } -Category External -Operation "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ" -Context @{"ã‚³ãƒãƒ³ãƒ‰å" = "sqlite3"; "æ“ä½œç¨®åˆ¥" = "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ" } -CleanupScript {
            # å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ç‰¹æœ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            Write-SystemLog "å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®çµ‚äº†ã‚³ãƒ¼ãƒ‰: $LASTEXITCODE" -Level "Info"
            
            # sqlite3ã‚³ãƒãƒ³ãƒ‰ã¯è¨­å®šæ¤œè¨¼ã§ç¢ºèªæ¸ˆã¿
        }
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ: $DatabasePath" -Level "Success"
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>50</td>
                <td style="font-family: monospace; font-size: 0.9em;">"DatabasePath" = $DatabasePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>54</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dbDir = Split-Path -Path $DatabasePath -Parent</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>55</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not (Test-Path $dbDir)) {
            Invoke-WithErrorHandling -ScriptBlock {
                New-Item -ItemType Directory -Path $dbDir -Force | Out-Null
                Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $dbDir" -Level "Info"
            } -Category External -Operation "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" -Context @{"ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" = $dbDir; "æ“ä½œç¨®åˆ¥" = "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" } -CleanupScript {
                # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œç‰¹æœ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                if (Test-Path $dbDir -ErrorAction SilentlyContinue) {
                    $fileInfo = Get-Item $dbDir -ErrorAction SilentlyContinue
                    if ($fileInfo) {
                        Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"
                    }
                }
            }
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>55</td>
                <td style="font-family: monospace; font-size: 0.9em;">Test-Path $dbDir</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>56</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -ScriptBlock {
                New-Item -ItemType Directory -Path $dbDir -Force | Out-Null
                Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $dbDir" -Level "Info"
            } -Category External -Operation "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" -Context @{"ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" = $dbDir; "æ“ä½œç¨®åˆ¥" = "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ" } -CleanupScript {
                # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œç‰¹æœ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
                if (Test-Path $dbDir -ErrorAction SilentlyContinue) {
                    $fileInfo = Get-Item $dbDir -ErrorAction SilentlyContinue
                    if ($fileInfo) {
                        Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"
                    }
                }
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>57</td>
                <td style="font-family: monospace; font-size: 0.9em;">New-Item -ItemType Directory -Path $dbDir -Force</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>57</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-Null</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ: $dbDir" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>59</td>
                <td style="font-family: monospace; font-size: 0.9em;">"ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹" = $dbDir</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>59</td>
                <td style="font-family: monospace; font-size: 0.9em;">"æ“ä½œç¨®åˆ¥" = "ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>61</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $dbDir -ErrorAction SilentlyContinue) {
                    $fileInfo = Get-Item $dbDir -ErrorAction SilentlyContinue
                    if ($fileInfo) {
                        Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"
                    }
                }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>62</td>
                <td style="font-family: monospace; font-size: 0.9em;">$fileInfo = Get-Item $dbDir -ErrorAction SilentlyContinue</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>63</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($fileInfo) {
                        Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"
                    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>64</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± - ã‚µã‚¤ã‚º: $($fileInfo.Length) bytes, æœ€çµ‚æ›´æ–°: $($fileInfo.LastWriteTime)" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>64</td>
                <td style="font-family: monospace; font-size: 0.9em;">$fileInfo.Length</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>64</td>
                <td style="font-family: monospace; font-size: 0.9em;">$fileInfo.LastWriteTime</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>70</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ã‚’é–‹å§‹ã—ã¾ã™..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>73</td>
                <td style="font-family: monospace; font-size: 0.9em;">$sqlStatements = New-DatabaseSchema</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>76</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -ScriptBlock {
            Invoke-DatabaseInitializationInternal -DatabasePath $DatabasePath -SqlStatements $sqlStatements
        } -Category External -Operation "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ" -Context @{"ã‚³ãƒãƒ³ãƒ‰å" = "sqlite3"; "æ“ä½œç¨®åˆ¥" = "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ" } -CleanupScript {
            # å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ç‰¹æœ‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            Write-SystemLog "å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®çµ‚äº†ã‚³ãƒ¼ãƒ‰: $LASTEXITCODE" -Level "Info"
            
            # sqlite3ã‚³ãƒãƒ³ãƒ‰ã¯è¨­å®šæ¤œè¨¼ã§ç¢ºèªæ¸ˆã¿
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>77</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-DatabaseInitializationInternal -DatabasePath $DatabasePath -SqlStatements $sqlStatements</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>78</td>
                <td style="font-family: monospace; font-size: 0.9em;">"ã‚³ãƒãƒ³ãƒ‰å" = "sqlite3"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>78</td>
                <td style="font-family: monospace; font-size: 0.9em;">"æ“ä½œç¨®åˆ¥" = "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒä½œæˆ"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>80</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã®çµ‚äº†ã‚³ãƒ¼ãƒ‰: $LASTEXITCODE" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>85</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸ: $DatabasePath" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>91</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config = Get-DataSyncConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>92</td>
                <td style="font-family: monospace; font-size: 0.9em;">$allSqlStatements = @()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>95</td>
                <td style="font-family: monospace; font-size: 0.9em;">$pragmas = New-OptimizationPragmas</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>96</td>
                <td style="font-family: monospace; font-size: 0.9em;">$allSqlStatements += $pragmas</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>99</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config.tables.PSObject.Properties.Name</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>100</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©ã‚’ç”Ÿæˆä¸­: $tableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>103</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dropTableSql = "DROP TABLE IF EXISTS $tableName;"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>104</td>
                <td style="font-family: monospace; font-size: 0.9em;">$allSqlStatements += $dropTableSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>106</td>
                <td style="font-family: monospace; font-size: 0.9em;">$createTableSql = New-CreateTableSql -TableName $tableName</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>107</td>
                <td style="font-family: monospace; font-size: 0.9em;">$allSqlStatements += $createTableSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>110</td>
                <td style="font-family: monospace; font-size: 0.9em;">return $allSqlStatements</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>123</td>
                <td style="font-family: monospace; font-size: 0.9em;">$combinedSql = $SqlStatements -join "`n`n"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>125</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteSchemaCommand -DatabasePath $DatabasePath -SqlContent $combinedSql</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>138</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tempSqlFile = [System.IO.Path]::GetTempFileName() + ".sql"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>140</td>
                <td style="font-family: monospace; font-size: 0.9em;">$encoding = Get-CrossPlatformEncoding</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>141</td>
                <td style="font-family: monospace; font-size: 0.9em;">$SqlContent</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>141</td>
                <td style="font-family: monospace; font-size: 0.9em;">Out-File -FilePath $tempSqlFile -Encoding $encoding</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>143</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "sqlite3ã‚³ãƒãƒ³ãƒ‰ã§SQLå®Ÿè¡Œä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>146</td>
                <td style="font-family: monospace; font-size: 0.9em;">$sqliteResult = & sqlite3 $DatabasePath ".read $tempSqlFile" 2>&1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>148</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($LASTEXITCODE -ne 0) {
            throw "sqlite3ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚çµ‚äº†ã‚³ãƒ¼ãƒ‰: $LASTEXITCODE, å‡ºåŠ›: $sqliteResult"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>149</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "sqlite3ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œã«å¤±æ•—ã—ã¾ã—ãŸã€‚çµ‚äº†ã‚³ãƒ¼ãƒ‰: $LASTEXITCODE, å‡ºåŠ›: $sqliteResult"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>152</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "sqlite3ã‚³ãƒãƒ³ãƒ‰ã§ã®å®Ÿè¡ŒãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>155</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (Test-Path $tempSqlFile) {
            Remove-Item -Path $tempSqlFile -Force
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>156</td>
                <td style="font-family: monospace; font-size: 0.9em;">Remove-Item -Path $tempSqlFile -Force</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DatabaseInitialization.psm1</td>
                <td>161</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Invoke-DatabaseInitialization'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>20</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config = Get-DataSyncConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>21</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncActionLabels = $config.sync_rules.sync_action_labels.mappings</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>24</td>
                <td style="font-family: monospace; font-size: 0.9em;">$cleanupScript = {
        try {
            Clear-Table -DatabasePath $DatabasePath -TableName "sync_result" -ShowStatistics:$false
            Write-SystemLog "ãƒªãƒˆãƒ©ã‚¤æº–å‚™: sync_resultãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ" -Level "Info"
        }
        catch {
            Write-SystemLog "sync_resultãƒ†ãƒ¼ãƒ–ãƒ«ã‚¯ãƒªã‚¢ä¸­ã«ã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -Level "Warning"
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>26</td>
                <td style="font-family: monospace; font-size: 0.9em;">Clear-Table -DatabasePath $DatabasePath -TableName "sync_result" -ShowStatistics:$false</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒªãƒˆãƒ©ã‚¤æº–å‚™: sync_resultãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "sync_resultãƒ†ãƒ¼ãƒ–ãƒ«ã‚¯ãƒªã‚¢ä¸­ã«ã‚¨ãƒ©ãƒ¼: $($_.Exception.Message)" -Level "Warning"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">$_.Exception.Message</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>34</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -Category External -Operation "ãƒ‡ãƒ¼ã‚¿åŒæœŸå‡¦ç†" -CleanupScript $cleanupScript -Context @{
        "DatabasePath" = $DatabasePath
    } -ScriptBlock {
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿åŒæœŸå‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™..." -Level "Info"
        
        # 0. ãƒªãƒˆãƒ©ã‚¤å¯¾å¿œ: sync_resultãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
        Clear-Table -DatabasePath $DatabasePath -TableName "sync_result"
        
        # 1. ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ã«å­˜åœ¨ã—ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼ˆæ–°è¦è¿½åŠ å¯¾è±¡ï¼‰ã‚’ç‰¹å®š
        Add-NewRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        
        # 2. æ›´æ–°ãŒã‚ã£ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‡¦ç†
        Add-UpdateRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        
        # 3. ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ã«ã—ã‹å­˜åœ¨ã—ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ï¼ˆå‰Šé™¤å¯¾è±¡ï¼‰ã‚’ç‰¹å®š
        Add-DeleteRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        
        # 4. å¤‰æ›´ã®ãªã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä¿æŒ
        Add-KeepRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        
        # 5. ãƒ•ã‚£ãƒ«ã‚¿é™¤å¤–ã•ã‚ŒãŸcurrent_dataã‚’KEEPã¨ã—ã¦è¿½åŠ ï¼ˆè¨­å®šæœ‰åŠ¹æ™‚ã®ã¿ï¼‰
        $config = Get-DataSyncConfig
        if ($config.data_filters.current_data.output_excluded_as_keep.enabled -eq $true) {
            Add-ExcludedCurrentDataAsKeep -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        }
        else {
            Write-SystemLog "é™¤å¤–ãƒ‡ãƒ¼ã‚¿ã®KEEPå‡ºåŠ›è¨­å®šãŒç„¡åŠ¹ã®ãŸã‚ã€ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™" -Level "Info"
        }
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿åŒæœŸå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -Level "Success"
        
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">"DatabasePath" = $DatabasePath</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>38</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿åŒæœŸå‡¦ç†ã‚’é–‹å§‹ã—ã¾ã™..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">Clear-Table -DatabasePath $DatabasePath -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>44</td>
                <td style="font-family: monospace; font-size: 0.9em;">Add-NewRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>47</td>
                <td style="font-family: monospace; font-size: 0.9em;">Add-UpdateRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>50</td>
                <td style="font-family: monospace; font-size: 0.9em;">Add-DeleteRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>53</td>
                <td style="font-family: monospace; font-size: 0.9em;">Add-KeepRecords -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>56</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config = Get-DataSyncConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>57</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($config.data_filters.current_data.output_excluded_as_keep.enabled -eq $true) {
            Add-ExcludedCurrentDataAsKeep -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels
        }
        else {
            Write-SystemLog "é™¤å¤–ãƒ‡ãƒ¼ã‚¿ã®KEEPå‡ºåŠ›è¨­å®šãŒç„¡åŠ¹ã®ãŸã‚ã€ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™" -Level "Info"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">Add-ExcludedCurrentDataAsKeep -DatabasePath $DatabasePath -SyncActionLabels $syncActionLabels</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>61</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "é™¤å¤–ãƒ‡ãƒ¼ã‚¿ã®KEEPå‡ºåŠ›è¨­å®šãŒç„¡åŠ¹ã®ãŸã‚ã€ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>64</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿åŒæœŸå‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>80</td>
                <td style="font-family: monospace; font-size: 0.9em;">$joinCondition = New-JoinCondition -LeftTableName "provided_data" -RightTableName "current_data" -LeftAlias "pd" -RightAlias "cd"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>81</td>
                <td style="font-family: monospace; font-size: 0.9em;">$currentDataKeys = Get-TableKeyColumns -TableName "current_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>82</td>
                <td style="font-family: monospace; font-size: 0.9em;">$currentDataKey = ($currentDataKeys | Select-Object -First 1)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>82</td>
                <td style="font-family: monospace; font-size: 0.9em;">$currentDataKeys</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>82</td>
                <td style="font-family: monospace; font-size: 0.9em;">Select-Object -First 1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>84</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®šä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>87</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns = Get-SyncResultInsertColumns</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>88</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumnsString = $insertColumns -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>90</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClause = New-SyncResultSelectClause -SourceTableName "provided_data" -SourceTableAlias "pd" -SyncAction $SyncActionLabels.ADD.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>92</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = @"
INSERT INTO sync_result ($insertColumnsString)
SELECT 
    $selectClause
FROM provided_data pd
LEFT JOIN current_data cd ON $joinCondition
WHERE cd.$currentDataKey IS NULL;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>101</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $query</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>104</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ–°è¦ãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>118</td>
                <td style="font-family: monospace; font-size: 0.9em;">$joinCondition = New-JoinCondition -LeftTableName "provided_data" -RightTableName "current_data" -LeftAlias "pd" -RightAlias "cd"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>120</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ›´æ–°ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®šä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>123</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns = Get-SyncResultInsertColumns</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>124</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumnsString = $insertColumns -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>126</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClause = New-PriorityBasedSyncResultSelectClause -SyncAction $SyncActionLabels.UPDATE.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>129</td>
                <td style="font-family: monospace; font-size: 0.9em;">$whereClause = New-ComparisonWhereClause -Table1Alias "pd" -Table2Alias "cd" -ComparisonType "different" -Table1Name "provided_data" -Table2Name "current_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>131</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = @"
INSERT INTO sync_result ($insertColumnsString)
SELECT 
    $selectClause
FROM provided_data pd
INNER JOIN current_data cd ON $joinCondition
WHERE 
    $whereClause;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>141</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $query</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>144</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æ›´æ–°ãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>158</td>
                <td style="font-family: monospace; font-size: 0.9em;">$joinCondition = New-JoinCondition -LeftTableName "current_data" -RightTableName "provided_data" -LeftAlias "cd" -RightAlias "pd"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>159</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataKeys = Get-TableKeyColumns -TableName "provided_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>161</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataKey = ($providedDataKeys | Select-Object -First 1)</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>161</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataKeys</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>161</td>
                <td style="font-family: monospace; font-size: 0.9em;">Select-Object -First 1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>163</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å‰Šé™¤å¯¾è±¡ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®šä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>166</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns = Get-SyncResultInsertColumns</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>167</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumnsString = $insertColumns -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>169</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClause = New-SyncResultSelectClause -SourceTableName "current_data" -SourceTableAlias "cd" -SyncAction $SyncActionLabels.DELETE.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>171</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = @"
INSERT INTO sync_result ($insertColumnsString)
SELECT 
    $selectClause
FROM current_data cd
LEFT JOIN provided_data pd ON $joinCondition
WHERE pd.$providedDataKey IS NULL;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>180</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $query</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>183</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å‰Šé™¤ãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>197</td>
                <td style="font-family: monospace; font-size: 0.9em;">$joinCondition = New-JoinCondition -LeftTableName "provided_data" -RightTableName "current_data" -LeftAlias "pd" -RightAlias "cd"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>198</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys = Get-TableKeyColumns -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>201</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataMappedKeys = @()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>202</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>203</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataField = Get-PriorityBasedSourceField -SyncResultField $syncResultKey -SourceTableName "provided_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>204</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataMappedKeys += "pd.$providedDataField"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>206</td>
                <td style="font-family: monospace; font-size: 0.9em;">$providedDataGroupBy = $providedDataMappedKeys -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>209</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultGroupBy = New-GroupByClause -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>211</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å¤‰æ›´ãªã—ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®šä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>214</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns = Get-SyncResultInsertColumns</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>215</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumnsString = $insertColumns -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>217</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClause = New-PriorityBasedSyncResultSelectClause -SyncAction $SyncActionLabels.KEEP.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>220</td>
                <td style="font-family: monospace; font-size: 0.9em;">$whereClause = New-ComparisonWhereClause -Table1Alias "pd" -Table2Alias "cd" -ComparisonType "same" -Table1Name "provided_data" -Table2Name "current_data"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>222</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = @"
INSERT INTO sync_result ($insertColumnsString)
SELECT 
    $selectClause
FROM provided_data pd
INNER JOIN current_data cd ON $joinCondition
WHERE 
    $whereClause
    AND ($providedDataGroupBy) NOT IN (SELECT $syncResultGroupBy FROM sync_result);
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>233</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $query</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>236</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å¤‰æ›´ãªã—ãƒ¬ã‚³ãƒ¼ãƒ‰è¿½åŠ å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>249</td>
                <td style="font-family: monospace; font-size: 0.9em;">$excludedTableName = "current_data_excluded"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>252</td>
                <td style="font-family: monospace; font-size: 0.9em;">$checkTableQuery = @"
SELECT name FROM sqlite_master 
WHERE type='table' AND name='$excludedTableName';
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>257</td>
                <td style="font-family: monospace; font-size: 0.9em;">$result = Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $checkTableQuery</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>259</td>
                <td style="font-family: monospace; font-size: 0.9em;">if (-not $result -or $result.Count -eq 0) {
        Write-SystemLog "é™¤å¤–ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™: $excludedTableName" -Level "Info"
        return
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>260</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "é™¤å¤–ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™: $excludedTableName" -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>264</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚£ãƒ«ã‚¿é™¤å¤–ã•ã‚ŒãŸcurrent_dataã‚’KEEPã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦è¿½åŠ ä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>267</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns = Get-CsvColumns -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>268</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumnsString = $insertColumns -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>271</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClauses = @()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>272</td>
                <td style="font-family: monospace; font-size: 0.9em;">$insertColumns</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>273</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($syncResultColumn -eq "sync_action") {
            $selectClauses += "'$($SyncActionLabels.KEEP.value)'"
        }
        elseif ($syncResultColumn -eq "syokuin_no") {
            # current_dataã®user_idã‚’syokuin_noã«ãƒãƒƒãƒ”ãƒ³ã‚°
            $selectClauses += "ced.user_id"
        }
        else {
            # ãã®ä»–ã®ã‚«ãƒ©ãƒ ã¯åŒåã§ãƒãƒƒãƒ”ãƒ³ã‚°
            $selectClauses += "ced.$syncResultColumn"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>274</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClauses += "'$($SyncActionLabels.KEEP.value)'"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>274</td>
                <td style="font-family: monospace; font-size: 0.9em;">$SyncActionLabels.KEEP.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>276</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($syncResultColumn -eq "sync_action") {
            $selectClauses += "'$($SyncActionLabels.KEEP.value)'"
        }
        elseif ($syncResultColumn -eq "syokuin_no") {
            # current_dataã®user_idã‚’syokuin_noã«ãƒãƒƒãƒ”ãƒ³ã‚°
            $selectClauses += "ced.user_id"
        }
        else {
            # ãã®ä»–ã®ã‚«ãƒ©ãƒ ã¯åŒåã§ãƒãƒƒãƒ”ãƒ³ã‚°
            $selectClauses += "ced.$syncResultColumn"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>278</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClauses += "ced.user_id"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>282</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClauses += "ced.$syncResultColumn"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>285</td>
                <td style="font-family: monospace; font-size: 0.9em;">$selectClause = $selectClauses -join ", "</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>287</td>
                <td style="font-family: monospace; font-size: 0.9em;">$query = @"
INSERT OR IGNORE INTO sync_result ($insertColumnsString)
SELECT 
    $selectClause
FROM $excludedTableName ced;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>294</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $query</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>297</td>
                <td style="font-family: monospace; font-size: 0.9em;">$countQuery = "SELECT COUNT(*) as count FROM $excludedTableName;"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>298</td>
                <td style="font-family: monospace; font-size: 0.9em;">$countResult = Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $countQuery</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>299</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($countResult -and $countResult[0]) { $countResult[0].count } else { 0 }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>299</td>
                <td style="font-family: monospace; font-size: 0.9em;">$countResult[0].count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>299</td>
                <td style="font-family: monospace; font-size: 0.9em;">0</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>301</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ•ã‚£ãƒ«ã‚¿é™¤å¤–ãƒ‡ãƒ¼ã‚¿ã‚’KEEPã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦è¿½åŠ ã—ã¾ã—ãŸ ($addedCount ä»¶)" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Invoke-DataSync.psm1</td>
                <td>304</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Invoke-DataSync'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>26</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling  -Operation "åŒæœŸãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ" -Category External -SuppressThrow:$true -ScriptBlock {
        Write-SystemLog "=== åŒæœŸå‡¦ç†å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ ===" -Level "Info" -ConsoleColor "Magenta" 
        
        # 1. å®Ÿè¡Œæƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³
        Write-SystemLog "--- å®Ÿè¡Œæƒ…å ± ---" -Level "Info" -ConsoleColor "Magenta" 
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $DatabasePath" -Level "Info" -ConsoleColor "Magenta" 
        Write-SystemLog "æä¾›ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: $ProvidedDataFilePath" -Level "Info" -ConsoleColor "Magenta" 
        Write-SystemLog "ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: $CurrentDataFilePath" -Level "Info" -ConsoleColor "Magenta" 
        
        $config = Get-DataSyncConfig
        Write-SystemLog "è¨­å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³: $($config.version)" -Level "Info" -ConsoleColor "Magenta" 
        $japanTime = [DateTime]::UtcNow.AddHours(9).ToString('yyyy-MM-dd HH:mm:ss')  
        Write-SystemLog "å®Ÿè¡Œæ™‚åˆ»: $japanTime" -Level "Info" -ConsoleColor "Magenta" 
        
        # sync_action_labelsè¨­å®šã‚’å–å¾—
        $syncActionLabels = $config.sync_rules.sync_action_labels.mappings
        
        # 2. ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³
        Write-SystemLog "--- ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆ ---" -Level "Info" -ConsoleColor "Magenta" 
        
        # å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ä»¶æ•°ã‚’ä¸€æ‹¬å–å¾—
        $allTablesQuery = @"
SELECT 'provided_data' as table_name, COUNT(*) as count FROM provided_data
UNION ALL
SELECT 'current_data' as table_name, COUNT(*) as count FROM current_data
UNION ALL
SELECT 'sync_result' as table_name, COUNT(*) as count FROM sync_result;
"@
        
        $tableResults = Invoke-SqliteCsvQuery -DatabasePath $DatabasePath -Query $allTablesQuery
        
        foreach ($tableResult in $tableResults) {
            Write-SystemLog "$($tableResult.table_name): $($tableResult.count) ä»¶" -Level "Info" -ConsoleColor "Magenta" 
        }
        
        # 3. åŒæœŸçµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³
        Write-SystemLog "--- åŒæœŸçµæœ ---" -Level "Info" -ConsoleColor "Magenta" 
        
        # è¨­å®šã‹ã‚‰å‹•çš„ã«ORDER BYå¥ã‚’ç”Ÿæˆ
        $syncActionLabels = $config.sync_rules.sync_action_labels.mappings
        
        $orderByCases = @()
        $displayOrder = 1
        
        foreach ($actionKey in $syncActionLabels.PSObject.Properties.Name) {
            $actionConfig = $syncActionLabels.$actionKey
            $actionName = $actionConfig.value
            $orderByCases += "        WHEN '$actionName' THEN $displayOrder"
            $displayOrder++
        }
        
        $orderByClause = $orderByCases -join "`n"
        
        $syncResultQuery = @"
SELECT 
    sync_action,
    COUNT(*) as count
FROM sync_result
GROUP BY sync_action
ORDER BY 
    CASE sync_action 
$orderByClause
        ELSE 999
    END;
"@
        
        $syncResults = Invoke-SqliteCsvQuery -DatabasePath $DatabasePath -Query $syncResultQuery
        
        $totalSyncRecords = 0
        foreach ($syncResult in $syncResults) {
            $action = $syncResult.sync_action
            $count = [int]$syncResult.count
            $totalSyncRecords += $count
            
            # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å‹•çš„ã«å–å¾—ï¼ˆãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ’é™¤ï¼‰
            $cleanAction = $action.ToString().Trim()
            
            # sync_action_labelsã‹ã‚‰è¨­å®šã‚’å–å¾—
            $actionConfig = $null
            
            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¯æ•°å€¤ï¼ˆ1, 2ç­‰ï¼‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€
            # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®valueã¨ä¸€è‡´ã™ã‚‹ã‚‚ã®ã‚’æ¤œç´¢
            foreach ($key in $syncActionLabels.PSObject.Properties.Name) {
                if ($syncActionLabels.$key.value -eq $cleanAction) {
                    $actionConfig = $syncActionLabels.$key
                    break
                }
            }
            
            if ($actionConfig) {
                $displayLabel = $actionConfig.value
                $actionDescription = $actionConfig.description
            }
            else {
                # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: è¨­å®šã«ãªã„å ´åˆã¯å…ƒã®å€¤ã‚’ãã®ã¾ã¾ä½¿ç”¨
                $displayLabel = $cleanAction
                $actionDescription = $cleanAction
            }

            Write-SystemLog "$actionDescription ($displayLabel): $count ä»¶" -Level "Info" -ConsoleColor "Magenta" 
        }

        if ($totalSyncRecords -gt 0) {
            Write-SystemLog "åŒæœŸå‡¦ç†ç·ä»¶æ•°: $totalSyncRecords ä»¶" -Level "Info" -ConsoleColor "Magenta" 
        }
    }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>27</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "=== åŒæœŸå‡¦ç†å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ ===" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>30</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "--- å®Ÿè¡Œæƒ…å ± ---" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>31</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«: $DatabasePath" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>32</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "æä¾›ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: $ProvidedDataFilePath" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>33</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«: $CurrentDataFilePath" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config = Get-DataSyncConfig</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "è¨­å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³: $($config.version)" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">$config.version</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>37</td>
                <td style="font-family: monospace; font-size: 0.9em;">$japanTime = [DateTime]::UtcNow.AddHours(9).ToString('yyyy-MM-dd HH:mm:ss')</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>38</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "å®Ÿè¡Œæ™‚åˆ»: $japanTime" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncActionLabels = $config.sync_rules.sync_action_labels.mappings</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>44</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "--- ãƒ‡ãƒ¼ã‚¿çµ±è¨ˆ ---" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>47</td>
                <td style="font-family: monospace; font-size: 0.9em;">$allTablesQuery = @"
SELECT 'provided_data' as table_name, COUNT(*) as count FROM provided_data
UNION ALL
SELECT 'current_data' as table_name, COUNT(*) as count FROM current_data
UNION ALL
SELECT 'sync_result' as table_name, COUNT(*) as count FROM sync_result;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>55</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableResults = Invoke-SqliteCsvQuery -DatabasePath $DatabasePath -Query $allTablesQuery</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>57</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableResults</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "$($tableResult.table_name): $($tableResult.count) ä»¶" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableResult.table_name</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>58</td>
                <td style="font-family: monospace; font-size: 0.9em;">$tableResult.count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>62</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "--- åŒæœŸçµæœ ---" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>65</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncActionLabels = $config.sync_rules.sync_action_labels.mappings</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>67</td>
                <td style="font-family: monospace; font-size: 0.9em;">$orderByCases = @()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>68</td>
                <td style="font-family: monospace; font-size: 0.9em;">$displayOrder = 1</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>70</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncActionLabels.PSObject.Properties.Name</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>71</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionConfig = $syncActionLabels.$actionKey</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>72</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionName = $actionConfig.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>73</td>
                <td style="font-family: monospace; font-size: 0.9em;">$orderByCases += "        WHEN '$actionName' THEN $displayOrder"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>74</td>
                <td style="font-family: monospace; font-size: 0.9em;">$displayOrder++</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>77</td>
                <td style="font-family: monospace; font-size: 0.9em;">$orderByClause = $orderByCases -join "`n"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>79</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultQuery = @"
SELECT 
    sync_action,
    COUNT(*) as count
FROM sync_result
GROUP BY sync_action
ORDER BY 
    CASE sync_action 
$orderByClause
        ELSE 999
    END;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>92</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResults = Invoke-SqliteCsvQuery -DatabasePath $DatabasePath -Query $syncResultQuery</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>94</td>
                <td style="font-family: monospace; font-size: 0.9em;">$totalSyncRecords = 0</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>95</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResults</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>96</td>
                <td style="font-family: monospace; font-size: 0.9em;">$action = $syncResult.sync_action</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>97</td>
                <td style="font-family: monospace; font-size: 0.9em;">$count = [int]$syncResult.count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>98</td>
                <td style="font-family: monospace; font-size: 0.9em;">$totalSyncRecords += $count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>101</td>
                <td style="font-family: monospace; font-size: 0.9em;">$cleanAction = $action.ToString().Trim()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>104</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionConfig = $null</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>108</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncActionLabels.PSObject.Properties.Name</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>109</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($syncActionLabels.$key.value -eq $cleanAction) {
                    $actionConfig = $syncActionLabels.$key
                    break
                }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>110</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionConfig = $syncActionLabels.$key</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>115</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($actionConfig) {
                $displayLabel = $actionConfig.value
                $actionDescription = $actionConfig.description
            }
            else {
                # ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: è¨­å®šã«ãªã„å ´åˆã¯å…ƒã®å€¤ã‚’ãã®ã¾ã¾ä½¿ç”¨
                $displayLabel = $cleanAction
                $actionDescription = $cleanAction
            }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>116</td>
                <td style="font-family: monospace; font-size: 0.9em;">$displayLabel = $actionConfig.value</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>117</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionDescription = $actionConfig.description</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>121</td>
                <td style="font-family: monospace; font-size: 0.9em;">$displayLabel = $cleanAction</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>122</td>
                <td style="font-family: monospace; font-size: 0.9em;">$actionDescription = $cleanAction</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>125</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "$actionDescription ($displayLabel): $count ä»¶" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>128</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($totalSyncRecords -gt 0) {
            Write-SystemLog "åŒæœŸå‡¦ç†ç·ä»¶æ•°: $totalSyncRecords ä»¶" -Level "Info" -ConsoleColor "Magenta" 
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>129</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "åŒæœŸå‡¦ç†ç·ä»¶æ•°: $totalSyncRecords ä»¶" -Level "Info" -ConsoleColor "Magenta"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Show-SyncResult.psm1</td>
                <td>134</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Show-SyncResult'</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>17</td>
                <td style="font-family: monospace; font-size: 0.9em;">Invoke-WithErrorHandling -ScriptBlock {
        # è¤‡åˆã‚­ãƒ¼å¯¾å¿œã®GROUP BYå¥ç”Ÿæˆ
        $groupByClause = New-GroupByClause -TableName "sync_result"
        $syncResultKeys = Get-TableKeyColumns -TableName "sync_result"
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚’ãƒã‚§ãƒƒã‚¯ä¸­..." -Level "Info"
        
        # é‡è¤‡ãƒã‚§ãƒƒã‚¯
        $duplicateQuery = @"
SELECT $groupByClause, COUNT(*) as count
FROM sync_result
GROUP BY $groupByClause
HAVING COUNT(*) > 1;
"@
        
        $duplicates = Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $duplicateQuery
        
        if ($duplicates -and $duplicates.Count -gt 0) {
            Write-Warning "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"
            foreach ($dup in $duplicates) {
                $keyValues = @()
                foreach ($key in $syncResultKeys) {
                    $keyValues += $dup.$key
                }
                $keyString = $keyValues -join ', '
                Write-Warning "  ($keyString): $($dup.count)ä»¶"
            }
            throw "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"
        }
        
        Write-SystemLog "ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Œäº†: å•é¡Œãªã—" -Level "Success"
        
    } -Operation "ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯" -Category External -SuppressThrow:$true</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>19</td>
                <td style="font-family: monospace; font-size: 0.9em;">$groupByClause = New-GroupByClause -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>20</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys = Get-TableKeyColumns -TableName "sync_result"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>22</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚’ãƒã‚§ãƒƒã‚¯ä¸­..." -Level "Info"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>25</td>
                <td style="font-family: monospace; font-size: 0.9em;">$duplicateQuery = @"
SELECT $groupByClause, COUNT(*) as count
FROM sync_result
GROUP BY $groupByClause
HAVING COUNT(*) > 1;
"@</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>32</td>
                <td style="font-family: monospace; font-size: 0.9em;">$duplicates = Invoke-SqliteCommand -DatabasePath $DatabasePath -Query $duplicateQuery</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>34</td>
                <td style="font-family: monospace; font-size: 0.9em;">if ($duplicates -and $duplicates.Count -gt 0) {
            Write-Warning "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"
            foreach ($dup in $duplicates) {
                $keyValues = @()
                foreach ($key in $syncResultKeys) {
                    $keyValues += $dup.$key
                }
                $keyString = $keyValues -join ', '
                Write-Warning "  ($keyString): $($dup.count)ä»¶"
            }
            throw "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"
        }</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-Warning "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>35</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys -join ', '</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>36</td>
                <td style="font-family: monospace; font-size: 0.9em;">$duplicates</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>37</td>
                <td style="font-family: monospace; font-size: 0.9em;">$keyValues = @()</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>38</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>39</td>
                <td style="font-family: monospace; font-size: 0.9em;">$keyValues += $dup.$key</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>41</td>
                <td style="font-family: monospace; font-size: 0.9em;">$keyString = $keyValues -join ', '</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>42</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-Warning "  ($keyString): $($dup.count)ä»¶"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>42</td>
                <td style="font-family: monospace; font-size: 0.9em;">$dup.count</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>44</td>
                <td style="font-family: monospace; font-size: 0.9em;">throw "é‡è¤‡ã—ãŸã‚­ãƒ¼ï¼ˆ$($syncResultKeys -join ', ')ï¼‰ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ:"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>44</td>
                <td style="font-family: monospace; font-size: 0.9em;">$syncResultKeys -join ', '</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>47</td>
                <td style="font-family: monospace; font-size: 0.9em;">Write-SystemLog "ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Œäº†: å•é¡Œãªã—" -Level "Success"</td>
            </tr>            <tr>
                <td>scripts/modules/Process/Test-DataConsistency.psm1</td>
                <td>52</td>
                <td style="font-family: monospace; font-size: 0.9em;">Export-ModuleMember -Function 'Test-DataConsistency'</td>
            </tr>        </table>
    </div></body>
</html>
